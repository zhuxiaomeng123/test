<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>单例模式-皇帝上朝3(self is)</title>
	<script type="text/javascript">
       /*
    function Person(name){
      //this=new object;    
      this.name=name;

      //return this;
      return {age:18};
    }
    var p1=new Person('Tom');
    var p2=new Person('Eugene');
    console.log(p1);
         */
		  (function(w){
               var king=null;
             function King(name){
              var slef=this;
            var fn=(function(){               
                return function(){
                    if(!king){
                      // king={
                      // name:'皇帝',
                      // id:Math.random()
                      // }
                    slef.name='皇帝';
                    slef.id=Math.random();  
                       king=slef;              
                    } 
                    return king;                   
                }              
            })();
              return fn();
             }

              King.prototype={
              	constructor:King,
              	__proto__:Object.prototype,
              	say:function(){
                  console.log(this.name+this.id+"say::平身");
              	}
              }

              King.getKing=(function(){
             	var king=null;
                return function(){
                	if(!king){
                		king=new King();
                	}
                	return king;
                }              	
              })();

             w.King=King;
		})(window);

             for (var i = 0; i <=5; i++) {
                 console.log("day"+i);
                 new King().say();
                 // King.getKing().say();
             }
	</script>
</head>
<body>
	
</body>
</html>