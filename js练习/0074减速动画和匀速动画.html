<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>减速动画和匀速动画</title>
<style type="text/css">
		*{
			margin: 0;
			padding: 0;
		}
		div{
			width: 100px;
			height: 100px;
			background: red;
			float: left;
			margin-right: 30px;
		}
	</style>
	<script type="text/javascript">
				  // var timer=null;
				  /*
				   function animation(obj,attr,iTarget){
          	clearInterval(obj.timer);
          	obj.timer=setInterval(function(){
          		var iSpeed=0;
          		
          		var curr=parseFloat(getComputedStyle(obj,false)[attr]);
          if(attr=='opacity'){
          			curr=curr*100;
          		}
          		if(curr>iTarget){
          			iSpeed=-20;
          		}else{
          			iSpeed=20;
          		}
          		if(Math.abs(iTarget-curr)<=Math.abs(iSpeed)){
          			  clearInterval(obj.timer);
          			  if(attr=='opacity'){
          			  	obj.style[attr]=iTarget/100;
          			  }else{
          			  	obj.style[attr]=iTarget+'px';
          			  	}
                 }else{
          			if(attr=='opacity'){
          				obj.style[attr]=(curr+iSpeed)/100;
          			}else{
          			   obj.style[attr]=curr+iSpeed+'px';
          			}		
          		 }
          	},30);
          }
*/
                /*默认的是减速动画,默认是false*/
		       function animation(obj,attr,iTarget,isLinear){
		    		clearInterval(obj.timer);
		    		var iSpeed=0;
		    		// isLinear=isLinear||true;
		    		obj.timer=setInterval(function(){
		    			var curr=parseFloat(getComputedStyle(obj,false)[attr]); 
		    			var isStop=false;
		    			if(attr=='opacity'){
		    				curr=Math.round(curr*100);  
		    			} 
		    			
		    			if(isLinear){
		    					     if(curr>iTarget){
          			                 iSpeed=-20;
          		                  }else{
          			                iSpeed=20;
          		                 }
                        	if(Math.abs(iTarget-curr)<=Math.abs(iSpeed)){
                        		isStop=true;
                        	}

		    			}else{
		    				   iSpeed=(iTarget-curr)/10;
		    			       iSpeed=iSpeed>0 ? Math.ceil(iSpeed):Math.floor(iSpeed);/*三木运算符*/
		    			          if(!iSpeed){
                        		  isStop=true
                        	     }
		    			  }  

                       if(isStop){
                       	// if(300=oBox.offsetLeft){
                       	clearInterval(obj.timer)
                       	if(isLinear){
                           if(attr=='opacity'){
          				obj.style[attr]=(curr+iSpeed)/100;
          			     }else{
          			   obj.style[attr]=curr+iSpeed+'px';
          			     }	
                       	}

                       }else{
                       	if(attr=='opacity'){
                       	obj.style[attr]=(curr+iSpeed)/100;
                       }else{
                       		obj.style[attr]=curr+iSpeed+'px';
                       }
                   }
                       console.log(iSpeed)
		    		},30);
		          }
		          window.onload=function(){
		          	var aDiv=document.getElementsByTagName('div');
		          	aDiv[0].onmouseover=function(){
		          		animation(this,'height',500,true);
		          	}
		          	aDiv[0].onmouseout=function(){
		          		animation(this,'height',100,true);
		          	}
		          		aDiv[1].onmouseover=function(){
		          		animation(this,'width',500);
		          	}
		          	aDiv[1].onmouseout=function(){
		          		animation(this,'width',100);
		          	}
		          		aDiv[2].onmouseover=function(){
		          		animation(this,'opacity',30);
		          	}
		          	aDiv[2].onmouseout=function(){
		          		animation(this,'opacity',100);
		          	}
		          }
	</script>
</head>
<body>
	<div id="div1"></div>
	<div id="div2"></div>
	<div id="div3"></div>
</body>
</html>